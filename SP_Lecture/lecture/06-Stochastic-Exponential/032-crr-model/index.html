
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Binomial Model aka Cox Ross Rubinstein Model - Stochastics</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto Mono";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#binomial-model-aka-cox-ross-rubinstein-model" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Stochastics" class="md-header__button md-logo" aria-label="Stochastics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Stochastics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Binomial Model aka Cox Ross Rubinstein Model
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to light"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../00-Introduction/000-notations/" class="md-tabs__link">
          
  
    
  
  Lecture

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Stochastics" class="md-nav__button md-logo" aria-label="Stochastics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Stochastics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Lecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-Introduction/000-notations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sets, Continuity and Measurability
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Sets, Continuity and Measurability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-Sets-Functions/010-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-Sets-Functions/011-sets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-Sets-Functions/012-measurability-topology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Measurable/Topological Sapces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-Sets-Functions/013-measurable-continuous-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Measurability/Continuity
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Measure Theory, Construction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Measure Theory, Construction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Measure/020-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Measure/021-measure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Measures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Measure/022-semi-ring-to-ring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From Semi-Ring to Ring
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Measure/023-ring-to-s-algebra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From Ring to $\sigma$-Algebra
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Expectation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Expectation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integration/030-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction/Notations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integration/031-expectation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expectation, Lebesgue's Convergence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integration/032-lp-spaces-inequalities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    $L^p$-Spaces and Classical Inequalities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integration/033-radon-nikodym-cond-exp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Radon-Nykodym and Conditional Expectation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integration/034-independence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Independence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integration/035-fubini-tonelli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fubini-Tonelli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integration/036-uniform-integrability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Uniform Integrability
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Discrete Time Stochastic Processes, Martingales
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Discrete Time Stochastic Processes, Martingales
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Martingales/040-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Martingales/041-discrete-time-processes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discrete Time Processes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Martingales/042-martingale-doob/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Martingales
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Martingales/043-martingale-as-convergence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Martingales Almost Sure Convergence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Martingales/044-martingale-lp-convergence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Martingales $L^p$ Convergence
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="binomial-model-aka-cox-ross-rubinstein-model">Binomial Model aka Cox Ross Rubinstein Model</h1>
<p>The Cox Ross Rubinstein model can litteraly be considered as the discrete time full analog to the Black-Scholes-Merton model.
The dynamic is entirely determined by the result of a coin toss every day, hence the following model:</p>
<h2 id="probability-model">Probability Model</h2>
<p>The space of coint toss sequences is given by <span class="arithmatex">\(\Omega = \{\omega = (\omega_1, \ldots, \omega_T) : \omega_t = \pm 1\}\)</span> where <span class="arithmatex">\(\omega=(\omega_1, \ldots, \omega_T)\)</span> represents each sequence of <span class="arithmatex">\(\pm1\)</span> as result of the coin toss.
As for the <span class="arithmatex">\(\sigma\)</span>-algebra of events we consider <span class="arithmatex">\(\mathcal{F}=2^\Omega\)</span>.
We also consider a probability measure <span class="arithmatex">\(P\)</span> such that <span class="arithmatex">\(P[\{\omega\}] &gt; 0\)</span> for every <span class="arithmatex">\(\omega\)</span>.</p>
<p>As for the information we consider the stochastic process <span class="arithmatex">\(Y=(Y_t)_{t=1, \ldots T}\)</span> given by</p>
<div class="arithmatex">\[
\begin{equation*}
  \begin{split}
    Y_t\colon \Omega &amp; \longmapsto \{-1, 1\}\\
              \omega &amp; \longrightarrow Y_t(\omega) = \omega_t =  \text{result of coin toss at time }t
  \end{split}
\end{equation*}
\]</div>
<p>In other terms the stochastic process <span class="arithmatex">\(Y\)</span> provides information about the result of the coin toss at each time.
We therefore define the filtration</p>
<div class="arithmatex">\[
\mathcal{F}_0 = \{\emptyset, \Omega\} \quad \text{and}\quad \mathcal{F}_t = \sigma\left( Y_s\colon s\leq t \right)
\]</div>
<p>In other terms, <span class="arithmatex">\(\mathcal{F}_t\)</span> is the set of events which have been revealed by all coin tosses up to time <span class="arithmatex">\(t\)</span>.
It can be shown that if <span class="arithmatex">\(\xi\)</span> is a <span class="arithmatex">\(\mathcal{F}_t\)</span>-measurable random variable, then this random variable only depends on the coin tosses up to time <span class="arithmatex">\(t\)</span>, that is </p>
<div class="arithmatex">\[
\xi(\omega) = \xi( \underbrace{\omega_1, \ldots, \omega_t}_{\text{Information up to $t$}}, \underbrace{\omega_{t+1}, \ldots, \omega_T}_{\text{Information after $t$}} ) = \xi( \omega_1, \ldots, \omega_t )
\]</div>
<h2 id="market-model">Market Model</h2>
<ul>
<li>
<p><strong>Bank account</strong> <span class="arithmatex">\(B=(B_t)_{t=0, \ldots, T}\)</span> whith</p>
<div class="arithmatex">\[
  B_0 = 1, \quad \text{and}\quad B_t = B_{t-1}(1+r) = (1+r)^t
\]</div>
<p>for a fixed interest rate <span class="arithmatex">\(r&gt;-1\)</span>.
Clearly, the bank account is predictable since the interest rate is constant.</p>
</li>
<li>
<p><strong>Single risky asset</strong> <span class="arithmatex">\(S = (S_t)_{t=0, \ldots, T}\)</span> where</p>
<div class="arithmatex">\[
  S_0&gt;0 \quad \text{and}\quad S_t = S_{t-1}\left( 1+R_t\right)
\]</div>
<p>where the returns of the stock <span class="arithmatex">\(R=(R_t)_{t=1, \ldots, T}\)</span> is a stochastic process given by</p>
<div class="arithmatex">\[
  \begin{align*}
    R_t(\omega) &amp; = 
    \begin{cases}
      u &amp; \text{if }\omega_t = 1\\
      d &amp; \text{if }\omega_t = -1
    \end{cases}
\end{align*}
\]</div>
<p>where <span class="arithmatex">\(-1&lt;d&lt;u\)</span> are constants.
Clearly, <span class="arithmatex">\(R_t\)</span> only depends on the result of the coin toss at time <span class="arithmatex">\(t\)</span>, which can also be seen from</p>
<div class="arithmatex">\[
    R_t = u 1_{\{Y_t = 1\}} + d 1_{\{Y_t = -1\}} = (u-d)1_{\{Y_t = 1\}} +d
\]</div>
<p>showing that <span class="arithmatex">\(S\)</span> is an adapted process.</p>
</li>
</ul>
<h2 id="no-arbitrage-and-pricing-measure">No arbitrage and Pricing Measure</h2>
<p>This financial model is called the binomial model or Cox, Ross, and Rubinstein model (CRR for short).</p>
<div class="admonition proposition">
<p class="admonition-title">Proposition</p>
<p>The CRR model is arbitrage-free if and only if <span class="arithmatex">\(d &lt; r &lt; u\)</span>.
In this case, the CRR model is complete with unique pricing measure <span class="arithmatex">\(P^\ast\)</span> equivalent to <span class="arithmatex">\(P\)</span>.
This risk pricing measure is characterized by the fact that the random variables <span class="arithmatex">\(R_1, \ldots, R_T\)</span> are iid with common distribution:</p>
<div class="arithmatex">\[
  P^\ast[R_t = u] = p = \frac{r - d}{u - d}, \quad t = 1, \ldots, T
\]</div>
</div>
<div class="admonition proof">
<p class="admonition-title">Proof</p>
<p>By the FTAP, arbitrage-free is equivalent to the existence of a pricing measure <span class="arithmatex">\(P^\ast\)</span> equivalent to <span class="arithmatex">\(P\)</span>.
Under such <span class="arithmatex">\(P^\ast\)</span>, the discounted price process is a martingale.
In particular, it holds:</p>
<div class="arithmatex">\[
  0 = E^\ast\left[ \Delta X_t \mid \mathcal{F}_{t-1} \right] = E^\ast\left[ X_{t-1} \left( \frac{1 + R_t}{1 + r} - 1 \right) \mid \mathcal{F}_{t-1} \right] = X_{t-1} E^\ast\left[ \frac{R_t - r}{1 + r} \mid \mathcal{F}_{t-1} \right]
\]</div>
<p>Since <span class="arithmatex">\(X_{t-1} &gt; 0\)</span> and <span class="arithmatex">\(R_t = (u-d)1_{\{Y_t = 1\}} +d\)</span>, it follows that</p>
<div class="arithmatex">\[
r = E^\ast[R_t \mid \mathcal{F}_{t-1}] = (u - d) P^\ast\left[ Y_t = 1 \mid \mathcal{F}_{t-1} \right] + d
\]</div>
<p>Showing that</p>
<div class="arithmatex">\[
P^\ast\left[ Y_t = 1 \mid \mathcal{F}_t \right] = \frac{r - d}{u - d}
\]</div>
<p>for every <span class="arithmatex">\(t = 0, \ldots, T\)</span>.</p>
<p>From this relation, we conclude three facts:</p>
<ul>
<li>The conditional distribution of <span class="arithmatex">\(P^\ast\)</span> under <span class="arithmatex">\(\mathcal{F}_{t-1}\)</span>, that is, <span class="arithmatex">\(P^\ast[\cdot \mid \mathcal{F}_{t-1}]\)</span>, is constant for every <span class="arithmatex">\(t = 0, \ldots, T-1\)</span>.
    Hence,
    [
      P^\ast\left[ Y_t = 1 \mid \mathcal{F}_t \right] = P^\ast\left[ Y_t = 1 \right] = P^\ast\left[ Y_1 = 1 \right]
    ]</li>
<li>
<p>Since <span class="arithmatex">\(P^\ast\)</span> is a probability measure equivalent to <span class="arithmatex">\(P\)</span>, it follows that</p>
<div class="arithmatex">\[
  0 &lt; \frac{r - d}{u - d} &lt; 1
\]</div>
<p>That is, <span class="arithmatex">\(d &lt; r &lt; u\)</span>.</p>
</li>
<li>
<p>The formula for the probability <span class="arithmatex">\(P^\ast\)</span> is uniquely determined, and therefore, if the market is arbitrage-free, it has to be complete.</p>
</li>
</ul>
<p>As for the independence of <span class="arithmatex">\(R\)</span>, it follows readily from the definition of <span class="arithmatex">\(P^\ast\)</span>.</p>
</div>
<div class="admonition remark">
<p class="admonition-title">Remark</p>
<p>Note that the distribution of the pricing measure <span class="arithmatex">\(P^\ast\)</span> is entirely given by <span class="arithmatex">\(P^\ast[R_t = u] = p\)</span>.
Indeed, since <span class="arithmatex">\(\{Y_t = 1\} =\{R_t=u\}\)</span> as well as <span class="arithmatex">\(\{Y_t = -1\} = \{R_t = d\}\)</span> it follows that <span class="arithmatex">\((Y_1, \ldots, Y_T)\)</span> are iid.
Hence, for <span class="arithmatex">\(\omega = (\omega_1, \ldots, \omega_T)\)</span> it holds that</p>
<div class="arithmatex">\[
    \begin{align*}
      P^\ast\left[ \{\omega\} \right] &amp; = P^\ast\left[ Y_1 = \omega_1, \ldots, Y_T = \omega_T \right]\\
      &amp; = P^\ast\left[ \cap_{t=1}^T \{Y_t = \omega_t\} \right]\\
      &amp; = \prod_{t=1}^T P^\ast[Y_t = \omega_t] &amp; &amp; \text{Independence of }Y_1, \ldots, Y_T\\
      &amp; = \prod_{t=1}^T P^\ast[Y_1 = \omega_t] &amp; &amp; \text{Identical distribution of }Y_1, \ldots, Y_T\\ 
      &amp; = p^l (1-p)^{T-l}
    \end{align*}
\]</div>
<p>where <span class="arithmatex">\(l = \# \{t \colon \omega_t = 1\}\)</span> is the number of <span class="arithmatex">\(1\)</span> in the sequence of coin tosses <span class="arithmatex">\(\omega = (\omega_1, \ldots, \omega_T)\)</span>.</p>
</div>
<p>Since the market is complete, we can therefore:</p>
<ul>
<li>
<p><strong>Price</strong> any European contingent claim <span class="arithmatex">\(C\)</span> uniquely by means of</p>
<div class="arithmatex">\[
  \pi(C) = E^\ast\left[ \frac{C}{(1 + r)^T} \right]
\]</div>
</li>
<li>
<p><strong>Replicate</strong> (or hedge) the claim by means of a strategy <span class="arithmatex">\(\eta\)</span> such that</p>
<div class="arithmatex">\[
  \pi(C) + \sum_{s=1}^T \eta_s \Delta X_s = \frac{C}{(1 + r)^T}
\]</div>
</li>
</ul>
<p>In particular, given the replicating strategy <span class="arithmatex">\(\eta\)</span>, we can even provide the (discounted) price at any time by means of</p>
<div class="arithmatex">\[
    V_t = \pi(C) + \sum_{s=1}^t \eta_s \Delta X_s = E^\ast\left[ \frac{C}{(1 + r)^T} \mid \mathcal{F}_t \right]
\]</div>
<p><strong>Pricing</strong> (i.e., computing <span class="arithmatex">\(\pi(C)\)</span>) and <strong>Hedging</strong> (i.e., finding <span class="arithmatex">\(\eta\)</span>) are two of three (managing risk is a fundamental component) main activities of financial institutions engaging in derivative trading.</p>
<p>Before any further assumptions, as for the price, since we have an explicit expression for <span class="arithmatex">\(P^\ast\)</span>, it holds that</p>
<div class="arithmatex">\[
\pi(C) = \sum_{\omega \in \Omega} \frac{C(\omega)}{(1+r)^T} P^\ast[\{\omega\}] = \sum_{\omega \in \Omega}\frac{C(\omega)}{(1+r)^T}p^{l(\omega)}(1-p)^{T-l(\omega)}
\]</div>
<p>where <span class="arithmatex">\(l(\omega) = \# \{t \colon \omega_t = 1\}\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This simple expression that can be implemented easily programatically hides however a very important fact.
The sum is processed over all possible paths of coin tosses, and the cardinality of which is equal to <span class="arithmatex">\(2^T\)</span>.
Even with such a very simple market, if we consider one year maturity by daily trading, it amounts for <span class="arithmatex">\(2^{260}\)</span> paths which largely outmatch any computational power.
Hence, it is not efficiently implementable, and without further assumptions, this curse of dimensionality can only be overcome through Monte-Carlo methods, sampling a large number, though less than <span class="arithmatex">\(2^{260}\)</span> of paths and approximating the expectation.</p>
</div>
<h2 id="reducing-complexity-vanilla-derivatives">Reducing Complexity: Vanilla Derivatives</h2>
<p>Many of the derivatives are plain vanilla European options, that is derivatives which discounted value only depends on the last value of the underlying:</p>
<div class="arithmatex">\[
H = \frac{C}{(1+r)^T} = h(S_T)
\]</div>
<p>where <span class="arithmatex">\(h\colon \mathbb{R} \to \mathbb{R}\)</span>.
For instance <span class="arithmatex">\(h(x) = (x-K)^+/(1+r)^T\)</span> the discounted profile of a call option.
However this option can only take <span class="arithmatex">\(T+1\)</span> values <span class="arithmatex">\(S_0(1+u)^l(1+d)^{T-l}\)</span> for <span class="arithmatex">\(l = 0, \ldots, T\)</span> with each values corresponding to <span class="arithmatex">\(C_T^l=T!/(l!(T-l)!)\)</span> different possible paths.
The computation of the price at time <span class="arithmatex">\(0\)</span> therefore simplifies to</p>
<div class="arithmatex">\[
\begin{align*}
  \pi(C) &amp; = \sum_{\omega \in \Omega} H(\omega)P^\ast[\{\omega\}]\\
         &amp; = \sum_{l=0}^T  h\left(S_0 (1+u)^l(1+d)^{T-l}\right) C_T^l p^l (1-p)^{T-l}
\end{align*}
\]</div>
<p>which turns the computation of the price from a <span class="arithmatex">\(2^T\)</span> to a <span class="arithmatex">\(T+1\)</span> sum.</p>
<h3 id="dynamic-pricing">Dynamic Pricing</h3>
<p>A further particularity of those options, is that the value of the discounted portfolio can also be computed explicitely through a simple backward technique.
This relies on the following mathematical result</p>
<div class="admonition proposition">
<p class="admonition-title">Proposition</p>
<p>Let <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Y\)</span> be two random variable where <span class="arithmatex">\(X\)</span> is <span class="arithmatex">\(\mathcal{F}_t\)</span>-measurable and <span class="arithmatex">\(Y\)</span> is independent of <span class="arithmatex">\(\mathcal{F}_t\)</span>.
Then for every function <span class="arithmatex">\(h:\colon \mathbb{R} \times \mathbb{R} \to \mathbb{R}\)</span> it holds (modulo integrability)</p>
<div class="arithmatex">\[
  E^{P^\ast}\left[ h(X, Y) |\mathcal{F}_t \right](\omega) = v(X(\omega))
\]</div>
<p>where <span class="arithmatex">\(v\colon \mathbb{R} \to \mathbb{R}\)</span> is a function defined as</p>
<div class="arithmatex">\[
  v(x) = E^{P^\ast}\left[ h(x, Y) \right]
\]</div>
</div>
<div class="admonition remark">
<p class="admonition-title">Remark</p>
<p>This proposition basically says that since <span class="arithmatex">\(Y\)</span> is independent of <span class="arithmatex">\(\mathcal{F}_t\)</span> and <span class="arithmatex">\(X\)</span> is <span class="arithmatex">\(\mathcal{F}_t\)</span> measurable, then computing the conditional expectation corresponds to freezing <span class="arithmatex">\(X(\omega)\)</span> and computing the expectation.
In not so adequate notations, </p>
<div class="arithmatex">\[
  E^{P^\ast}\left[ h(X, Y) | \mathcal{F}_t \right](\omega) = E^{P^\ast}\left[ h(x, Y) | x = X(\omega) \right]
\]</div>
</div>
<p>This allows us to state the discrete formulation of partial differential equation type for the portfolio value:</p>
<div class="admonition proposition">
<p class="admonition-title">Proposition</p>
<p>For a european vanilla option <span class="arithmatex">\(H = h(S_T)\)</span>, it holds that that the discounted value of the hedging portfolio is equal to</p>
<div class="arithmatex">\[
  V_t = v_t(S_t)
\]</div>
<p>where <span class="arithmatex">\(v_t \colon \mathbb{R} \to \mathbb{R}\)</span> for <span class="arithmatex">\(t=T, \ldots, 0\)</span> is recursively defined as</p>
<div class="arithmatex">\[
  \begin{equation*}
    \begin{cases}
      v_T(x)  = h(S_T)\\
      \\
      v_t(x)  = p v_{t+1}(x(1+u)) + (1-p)v_t(x(1+d)) &amp; \text{for }t = T-1, \ldots, 0
    \end{cases}
  \end{equation*}
\]</div>
</div>
<div class="admonition proof">
<p class="admonition-title">Proof</p>
<p>By finite inverse induction.</p>
<ul>
<li>For <span class="arithmatex">\(t=T\)</span> it holds that <span class="arithmatex">\(V_t = H = h(S_T) = v_T(S_T)\)</span> by definition.</li>
<li>
<p>For <span class="arithmatex">\(t=T-1\)</span>, by the martingale property, it holds that <span class="arithmatex">\(V_{T-1} = E^{P^\ast}[V_T |\mathcal{F}_{T-1}] = E^{P^\ast}[v_T(S_T)|\mathcal{F}_{T-1}]\)</span>.
    Now using the proposition above, since <span class="arithmatex">\(S_{T-1}\)</span> is <span class="arithmatex">\(\mathcal{F}_{T-1}\)</span>-measurable and <span class="arithmatex">\(R_T\)</span> is independent to <span class="arithmatex">\(\mathcal{F}_{T-1}\)</span> we get</p>
<div class="arithmatex">\[
  \begin{equation*}
    V_T  = E^{P^\ast}\left[ v_T(S_{T-1}(1+R_T)) |\mathcal{F}_{T-1} \right] = v_{T-1}(S_{T-1}) 
  \end{equation*}
\]</div>
<p>for</p>
<div class="arithmatex">\[
  \begin{align*}
    v_{T-1}(x) &amp; = E^{P^\ast}\left[ v_T(x (1+R_T)) \right]\\
               &amp; = E^{P^\ast}\left[ v_T(x(1+R_1)) \right] &amp;&amp; R_1, \ldots, R_T \text{ are iid}\\
               &amp; = pv_T(x(1+u)) + (1-p)v_T(x(1+d))
  \end{align*}
\]</div>
</li>
</ul>
<p>The next steps <span class="arithmatex">\(T-2, \ldots, 0\)</span> follows the same argumentation.</p>
</div>
<h3 id="dynamic-hedging">Dynamic Hedging</h3>
<p>As for the second part of the job, hedging, we know that there exists a predictable strategy <span class="arithmatex">\(\eta = (\eta_t)_{t=1, \ldots, T}\)</span> that will hedge the claim.
Again, in the setting of plain vanilla european option, these ones can be computed backwardly as soon as you computed the sequence of functions <span class="arithmatex">\(v_0, \ldots, v_T\)</span>.</p>
<div class="admonition proposition">
<p class="admonition-title">Proposition</p>
<p>For a european vanilla option <span class="arithmatex">\(H= h(S_T)\)</span> the hedging strategy <span class="arithmatex">\(\eta = (\eta_t)_{t=1, T}\)</span> is given by</p>
<div class="arithmatex">\[
  \eta_t = \Delta_t(S_{t-1})
\]</div>
<p>where <span class="arithmatex">\(\Delta_t \colon \mathbb{R} \to \mathbb{R}\)</span> for <span class="arithmatex">\(t=1, \ldots, T\)</span> are functions recursively computed as follows</p>
<div class="arithmatex">\[
    \displaystyle \Delta_t(x) = (1+r)^t \frac{v_t(x(1+u)) - v_t(x(1+d))}{x(1+u) - x(1+d)}
\]</div>
</div>
<div class="admonition remark">
<p class="admonition-title">Remark</p>
<p>The function <span class="arithmatex">\(\Delta_t\)</span> is called the <strong>delta</strong> hedge in finance.
The notation is a bit unfortunate in regards to our notation for difference, but is makes sense if you notice that this is the discrete version of the derivative of the portfolio value with respect to the underlying asset <span class="arithmatex">\(\partial v_t/\partial S_t\)</span> coinciding with the Black and Sholes framework.</p>
</div>
<div class="admonition proof">
<p class="admonition-title">Proof</p>
<p>Let us consider a given time <span class="arithmatex">\(1\leq t\leq T\)</span>.
The hedging strategy <span class="arithmatex">\(\eta = (\eta_t)_{t=1, \ldots, T}\)</span> is such that</p>
<div class="arithmatex">\[
    V_{t} - V_{t-1} = \eta_t (X_t - X_{t-1}) 
\]</div>
<p>On the one hand, knowing <span class="arithmatex">\(S_0, \ldots, S_{t-1}\)</span>, since <span class="arithmatex">\(\eta_t\)</span> is predictable the right hand side can only take two values</p>
<div class="arithmatex">\[
  \begin{align*}
    \eta_t (X_t - X_{t-1}) &amp; = \displaystyle \eta_t \frac{S_{t-1}}{(1+r)^t}\left( R_t - r  \right)
    \\
    &amp; =\displaystyle \eta_t \frac{S_{t-1}}{(1+r)^t}
      \begin{cases}
        u-r &amp; \text{if } \omega_t = 1\\
        \\
        d-r &amp; \text{if } \omega_{t} = -1
      \end{cases}
  \end{align*}
\]</div>
<p>On the other hand, since <span class="arithmatex">\(V_t = v_t(S_t) = v_t(S_{t-1}(1+R_t))\)</span> as well as <span class="arithmatex">\(V_{t-1} = v_{t-1}(S_{t-1}) = p v_t(S_{t-1}(1+u)) + (1-p) v_t(S_{t-1}(1+d))\)</span>, it follows that the left hand side can only take two values given <span class="arithmatex">\(S_0, \ldots, S_{t-1}\)</span>.</p>
<div class="arithmatex">\[
  \begin{align*}
    V_t - V_{t-1} &amp; = \displaystyle v_t(S_{t-1}(1+R_t)) - p v_t(S_{t-1}(1+u)) - (1-p) v_t(S_{t-1}(1+d))\\
    \\
                  &amp; = \displaystyle
    \begin{cases}
     (1-p) \left(v_t(S_{t-1}(1+u)) - v_t(S_{t-1}(1+d))\right) &amp; \text{if }\omega_t =1\\
    \\
     p \left(v_t(S_{t-1}(1+u)) - v_t(S_{t-1}(1+d))\right) &amp; \text{if }\omega_t =-1\\
    \end{cases}
  \end{align*}
\]</div>
<p>Puting these two equation together and solving for <span class="arithmatex">\(\eta_t\)</span>, knowing that <span class="arithmatex">\(p = (r-d)/(u-d)\)</span> yields that knowing <span class="arithmatex">\(S_0, \ldots, S_{t-1}\)</span> we have</p>
<div class="arithmatex">\[
  \eta_t = (1+r)^t \frac{v_t(S_{t-1}(1+u)) - v_t(S_{t-1}(1+d))}{S_{t-1}(1+u) - S_{t-1}(1+d)} = \Delta_t(S_{t-1})
\]</div>
</div>
<div class="admonition remark">
<p class="admonition-title">Remark</p>
<p>The derivation of the functions <span class="arithmatex">\(v_t\)</span> and <span class="arithmatex">\(\Delta_t\)</span> for <span class="arithmatex">\(t=0, \ldots, T\)</span> can be extended to the general case of options depending on the full path, that is with discounted formulation <span class="arithmatex">\(H = h(S_0, \ldots, S_T)\)</span> for some function <span class="arithmatex">\(h:\mathbb{R}^{T+1} \to \mathbb{R}\)</span> following the same argumentation where</p>
<div class="arithmatex">\[
    \begin{equation*}
        \begin{cases}
            v_T(x_0, \ldots, x_{T}) &amp; = h(x_0, \ldots, x_T)\\
            \\
            v_t(x_0, \ldots, x_t) &amp; = p v_{t+1}(x_0, \ldots, x_{t}, x_t(1+u)) + (1-p)v_{t+1}(x_0, \ldots, x_{t}, x_t(1+d))
        \end{cases}
    \end{equation*}
\]</div>
<p>as well as</p>
<div class="arithmatex">\[
    \Delta_t(x_0, \ldots, x_{t-1}) = (1+r)^t \frac{v_{t}(x_0, \ldots, x_{t-1}, x_{t-1}(1+u)) - v_{t}(x_0, \ldots, x_{t-1}, x_{t-1}(1+d))}{x_{t-1}(1+u) - x_{t-1}(1+d)}
\]</div>
<p>Though those expression are valid and simple to write down mathematically, to solve those numerically hits the problem of the curse of dimensionality, since those depends on every possible combinations of paths for the price <span class="arithmatex">\((x_0, \ldots, x_t)\)</span> at each time <span class="arithmatex">\(t\)</span>, which amounts to <span class="arithmatex">\(2^T\)</span>.</p>
</div>
<h3 id="implementation">Implementation</h3>
<p class="annotate">The implementation in a binomial model(1) for plain vanilla options is classical and relatively straightforward after reformulating the problem in terms of matrices. </p>
<ol>
<li>the BS model turns into resolving pde which unless you have an explicit expression turns into finite difference methods or alike kinds which are similar.</li>
</ol>
<p class="annotate">The main computational issue is to derive <span class="arithmatex">\(v_t(x)\)</span> for every attainable <span class="arithmatex">\(x=S_t\)</span> and every <span class="arithmatex">\(t\)</span>.
To do so as in numerical methods for PDE we consider matrix/vector notations(1) of values</p>
<ol>
<li>In terms of computer memory and efficiency, this certainly not the best approach. But in that case you don't use python but rather low level programming languages like rust or C and look at structures like Btreemaps and the likes. In python <code>numpy</code> does just fine and the dimension is no longer an issue for modern computers.</li>
</ol>
<p>We will store the value of the portfolio and the delta hedging into a diagonal matrices <span class="arithmatex">\((T+1)\times (T+1)\)</span> and <span class="arithmatex">\(T\times T\)</span> with column vectors <span class="arithmatex">\(\boldsymbol{v}_t\)</span> in <span class="arithmatex">\(\mathbb{R}^{T+1}\)</span> and <span class="arithmatex">\(\boldsymbol{\Delta}_t\)</span> as follows</p>
<div class="arithmatex">\[
\begin{equation*}
\boldsymbol{v}_t = 
\begin{bmatrix}
    v_t(S_0(1+u)^t)\\
    v_t(S_0(1+u)^{t-1}(1+d))\\
    \vdots 
    \\
    v_t(S_0(1+d)^t)\\
    0
    \\
    \vdots
    \\
    0
\end{bmatrix}
\quad \text{and}\quad
\boldsymbol{\Delta}_t = 
\begin{bmatrix}
\Delta_t(S_0(1+u)^{t-1})\\
\Delta_t(S_0(1+u)^{t-2}(1+d))\\
\vdots
\\
\Delta_t(S_0(1+d)^{t-1})
\\
0
\\
\vdots
0
\end{bmatrix}
\end{equation*}
\]</div>
<p>for <span class="arithmatex">\(t=0, \ldots, T\)</span>. 
and we apply the recursion up to <span class="arithmatex">\(0\)</span>.
Once <span class="arithmatex">\(\boldsymbol{v}_t\)</span> are calculated, and stored, the heding strategy can be computed directly.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># Computation of the discounted portfolio value</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># claim is the function C = f(S_T)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># not efficient in this form (python is bad with loops) but clear in terms of loops</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># does not verify if -1 &lt; d&lt; r&lt; u!!!</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">portfolio_value</span><span class="p">(</span><span class="n">claim</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="c1"># value of the portfolio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="c1"># stock prices tree</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="c1"># hedging strategy</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="c1"># initialize the stock tree</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">S0</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>            <span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">S0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">u</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="n">l</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="c1"># risk neutral probability</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="c1"># initialization of the portfolio value at time T</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="n">v</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">claim</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">T</span><span class="p">,:])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">r</span><span class="p">)</span> <span class="o">**</span> <span class="n">T</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="c1"># Compute backwardly the discounted portfolio value and the hedging</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>            <span class="n">vup</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>            <span class="n">vdown</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>            <span class="n">sup</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">u</span><span class="p">)</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>            <span class="n">sdown</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>            <span class="c1"># delta hedging</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>            <span class="n">delta</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">r</span><span class="p">)</span> <span class="o">**</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">vup</span> <span class="o">-</span> <span class="n">vdown</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sup</span> <span class="o">-</span> <span class="n">sdown</span><span class="p">)</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>            <span class="c1"># portfolio value</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>            <span class="n">v</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">vup</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">vdown</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>        <span class="s2">&quot;Stock&quot;</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>        <span class="s2">&quot;portfolio&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>        <span class="s2">&quot;delta&quot;</span><span class="p">:</span> <span class="n">delta</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>    <span class="p">}</span>
</span></code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.tabs.link", "content.code.copy", "content.code.annotate", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../javascripts/node_modules/mathjax/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>